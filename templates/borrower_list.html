{% extends "base.html" %} {% block title %}List Borrowers - Library Demo{% endblock %} {% block content %}

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>List Borrowers</h2>
        <a href="{{ url_for('borrower_manage') }}" class="btn btn-primary">Add New Borrower</a>
    </div>

    <!-- Search Form -->
    <div class="bg-light p-4 rounded mb-4">
        <form method="POST" action="{{ url_for('borrower_list') }}">
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="firstname" class="form-label">First Name</label>
                    <input type="text" class="form-control" id="firstname" name="firstname" placeholder="Search by first name..." value="{{ firstname_search or '' }}" />
                </div>

                <div class="col-md-4 mb-3">
                    <label for="familyname" class="form-label">Family Name</label>
                    <input type="text" class="form-control" id="familyname" name="familyname" placeholder="Search by family name..." value="{{ familyname_search or '' }}" />
                </div>

                <div class="col-md-4 mb-3 d-flex align-items-end">
                    <div>
                        <button type="submit" class="btn btn-primary me-2">Search</button>
                        <a href="{{ url_for('borrower_list') }}" class="btn btn-secondary">Clear</a>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <!-- Search Results -->
    {% if borrowers or (firstname_search or familyname_search) %} {% if borrowers %}
    <div class="mb-4">
        <h5 class="mb-3">Search Results ({{ borrowers|length }} borrowers found)</h5>
        <table class="table table-striped table-hover">
            <thead class="table-dark">
                <tr>
                    <th>Name</th>
                    <th>Date of Birth</th>
                    <th>Address</th>
                    <th>Suburb</th>
                    <th>City</th>
                    <th>Postcode</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for borrower in borrowers %}
                <tr>
                    <td><strong>{{ borrower.familyname }} {{ borrower.firstname }}</strong></td>
                    <td>
                        {% if borrower.dateofbirth %} {{ borrower.dateofbirth.strftime('%d %b %Y') }} {% else %}
                        <span class="text-muted">-</span>
                        {% endif %}
                    </td>
                    <td>{{ borrower.address or '-' }}</td>
                    <td>{{ borrower.suburb or '-' }}</td>
                    <td>{{ borrower.city or '-' }}</td>
                    <td>{{ borrower.postcode or '-' }}</td>
                    <td>
                                                    <a href="{{ url_for('borrower_manage', borrower_id=borrower.borrowerid) }}" class="btn btn-sm btn-outline-primary">Edit</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="alert alert-warning" role="alert">
        <h5 class="alert-heading">No borrowers found</h5>
        <p>No borrowers match your search criteria. Please try different search terms.</p>
    </div>
    {% endif %} {% else %}
    <div class="alert alert-info" role="alert">
        <h5 class="alert-heading">Welcome to Borrower Management</h5>
        <p>Use the search form above to find borrowers in our system. You can search by first name, family name, or both. Leave all fields empty to see all borrowers.</p>
    </div>
    {% endif %}
</div>

{% endblock %}
